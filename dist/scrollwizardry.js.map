{"version":3,"file":"scrollwizardry.js","sources":["../src/_util.js","../src/Event.js","../src/Indicator.js","../src/Scene.js","../src/Controller.js","../src/index.js"],"sourcesContent":["/* eslint-env browser */\r\n\r\nconst DEBUG = false;\r\n\r\nconst U = {};\r\n\r\nlet i;\r\n\r\n/**\r\n   * ------------------------------\r\n   * Type testing\r\n   * ------------------------------\r\n   */\r\n\r\nconst _type = v => Object.prototype.toString.call(v).replace(/^\\[object (.+)\\]$/, '$1').toLowerCase();\r\n_type.String = v => _type(v) === 'string';\r\n_type.Function = v => _type(v) === 'function';\r\n_type.Array = v => Array.isArray(v);\r\n_type.Number = v => !_type.Array(v) && (v - parseFloat(v) + 1) >= 0;\r\n_type.DomElement = o => (typeof HTMLElement === 'object' || typeof HTMLElement === 'function' ? o instanceof HTMLElement || o instanceof SVGElement : // DOM2\r\n  o && typeof o === 'object' && o !== null && o.nodeType === 1 && typeof o.nodeName === 'string');\r\nU.type = _type;\r\n\r\n/**\r\n   * ------------------------------\r\n   * Internal helpers\r\n   * ------------------------------\r\n   */\r\n\r\n// get current style IE safe (otherwise IE would return calculated values for 'auto')\r\nconst _getComputedStyle = elem => (elem.currentStyle ? elem.currentStyle : window.getComputedStyle(elem));\r\n\r\n// get element dimension (width or height)\r\nconst _dimension = (which, elem, outer, includeMargin) => {\r\n  elem = (elem === document) ? window : elem;\r\n  if (elem === window) {\r\n    includeMargin = false;\r\n  } else if (!_type.DomElement(elem)) {\r\n    return 0;\r\n  }\r\n  which = which.charAt(0).toUpperCase() + which.substr(1).toLowerCase();\r\n  let dimension = (outer ? elem[`offset${which}`] || elem[`outer${which}`] : elem[`client${which}`] || elem[`inner${which}`]) || 0;\r\n  if (outer && includeMargin) {\r\n    const style = _getComputedStyle(elem);\r\n    dimension += which === 'Height' ? U.floatVal(style.marginTop) + U.floatVal(style.marginBottom) : U.floatVal(style.marginLeft) + U.floatVal(style.marginRight);\r\n  }\r\n  return dimension;\r\n};\r\n\r\n  // converts 'margin-top' into 'marginTop'\r\nconst _camelCase = str => str.replace(/^[^a-z]+([a-z])/g, '$1').replace(/-([a-z])/g, g => g[1].toUpperCase());\r\n\r\n/**\r\n   * ------------------------------\r\n   * External helpers\r\n   * ------------------------------\r\n   */\r\n\r\n// parse float and fall back to 0.\r\nU.floatVal = number => parseFloat(number) || 0;\r\n\r\n// extend obj â€“ same as jQuery.extend({}, objA, objB)\r\nU.extend = function (obj) {\r\n  obj = obj || {};\r\n  for (i = 1; i < arguments.length; i++) {\r\n    if (!arguments[i]) {\r\n      continue;\r\n    }\r\n    for (const key in arguments[i]) {\r\n      if (arguments[i].hasOwnProperty(key)) {\r\n        obj[key] = arguments[i][key];\r\n      }\r\n    }\r\n  }\r\n  return obj;\r\n};\r\n\r\n// check if a css display type results in margin-collapse or not\r\nU.isMarginCollapseType = str => ['block', 'flex', 'list-item', 'table', '-webkit-box'].indexOf(str) > -1;\r\n\r\n// implementation of requestAnimationFrame\r\n// based on https://gist.github.com/paulirish/1579671\r\n\r\nlet lastTime = 0;\r\n\r\nconst vendors = ['ms', 'moz', 'webkit', 'o'];\r\nlet _requestAnimationFrame = window.requestAnimationFrame;\r\nlet _cancelAnimationFrame = window.cancelAnimationFrame;\r\n\r\n// try vendor prefixes if the above doesn't work\r\nfor (i = 0; !_requestAnimationFrame && i < vendors.length; ++i) {\r\n  _requestAnimationFrame = window[`${vendors[i]}RequestAnimationFrame`];\r\n  _cancelAnimationFrame = window[`${vendors[i]}CancelAnimationFrame`] || window[`${vendors[i]}CancelRequestAnimationFrame`];\r\n}\r\n\r\n// fallbacks\r\nif (!_requestAnimationFrame) {\r\n  _requestAnimationFrame = (callback) => {\r\n    const currTime = new Date().getTime();\r\n    const timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n    const id = window.setTimeout(() => { callback(currTime + timeToCall); }, timeToCall);\r\n    lastTime = currTime + timeToCall;\r\n    return id;\r\n  };\r\n}\r\n\r\nif (!_cancelAnimationFrame) {\r\n  _cancelAnimationFrame = (id) => {\r\n    window.clearTimeout(id);\r\n  };\r\n}\r\n\r\nU.rAF = _requestAnimationFrame.bind(window);\r\nU.cAF = _cancelAnimationFrame.bind(window);\r\n\r\nconst loglevels = ['error', 'warn', 'log'];\r\n\r\nconst console = window.console || {};\r\n\r\nconsole.log = console.log || (() => {}); // no console log, well - do nothing then...\r\n\r\n// make sure methods for all levels exist.\r\nfor (i = 0; i < loglevels.length; i++) {\r\n  const method = loglevels[i];\r\n  if (!console[method]) {\r\n    console[method] = console.log; // prefer .log over nothing\r\n  }\r\n}\r\n\r\nU.log = function (loglevel) {\r\n  if (!DEBUG) {\r\n    return;\r\n  }\r\n  if (loglevel > loglevels.length || loglevel <= 0) loglevel = loglevels.length;\r\n  const now = new Date();\r\n  const time = `${(`0${now.getHours()}`).slice(-2)}:${(`0${now.getMinutes()}`).slice(-2)}:${(`0${now.getSeconds()}`).slice(-2)}:${(`00${now.getMilliseconds()}`).slice(-3)}`;\r\n  const method = loglevels[loglevel - 1];\r\n  const args = Array.prototype.splice.call(arguments, 1);\r\n  const func = Function.prototype.bind.call(console[method], console);\r\n  args.unshift(time);\r\n  func.apply(console, args);\r\n};\r\n\r\n/**\r\n   * ------------------------------\r\n   * DOM Element info\r\n   * ------------------------------\r\n   */\r\n// always returns a list of matching DOM elements, from a selector, a DOM element or an list of elements or even an array of selectors\r\nconst _get = {};\r\n_get.elements = (selector) => {\r\n  let arr = [];\r\n  if (_type.String(selector)) {\r\n    try {\r\n      selector = document.querySelectorAll(selector);\r\n    } catch (e) { // invalid selector\r\n      return arr;\r\n    }\r\n  }\r\n  if (_type(selector) === 'nodelist' || _type.Array(selector)) {\r\n    for (let i = 0, ref = arr.length = selector.length; i < ref; i++) { // list of elements\r\n      const elem = selector[i];\r\n      arr[i] = _type.DomElement(elem) ? elem : _get.elements(elem); // if not an element, try to resolve recursively\r\n    }\r\n  } else if (_type.DomElement(selector) || selector === document || selector === window) {\r\n    arr = [selector]; // only the element\r\n  }\r\n  return arr;\r\n};\r\n// get scroll top value\r\n_get.scrollTop = elem => ((elem && typeof elem.scrollTop === 'number') ? elem.scrollTop : window.pageYOffset || 0);\r\n// get scroll left value\r\n_get.scrollLeft = elem => ((elem && typeof elem.scrollLeft === 'number') ? elem.scrollLeft : window.pageXOffset || 0);\r\n// get element height\r\n_get.width = (elem, outer, includeMargin) => _dimension('width', elem, outer, includeMargin);\r\n// get element width\r\n_get.height = (elem, outer, includeMargin) => _dimension('height', elem, outer, includeMargin);\r\n\r\n// get element position (optionally relative to viewport)\r\n_get.offset = (elem, relativeToViewport) => {\r\n  const offset = { top: 0, left: 0 };\r\n  if (elem && elem.getBoundingClientRect) { // check if available\r\n    const rect = elem.getBoundingClientRect();\r\n    offset.top = rect.top;\r\n    offset.left = rect.left;\r\n    if (!relativeToViewport) { // clientRect is by default relative to viewport...\r\n      offset.top += _get.scrollTop();\r\n      offset.left += _get.scrollLeft();\r\n    }\r\n  }\r\n  return offset;\r\n};\r\nU.get = _get;\r\n\r\n/**\r\n   * ------------------------------\r\n   * DOM Element manipulation\r\n   * ------------------------------\r\n   */\r\n\r\nU.addClass = (elem, classname) => {\r\n  if (classname) {\r\n    if (elem.classList) { elem.classList.add(classname); } else { elem.className += ` ${classname}`; }\r\n  }\r\n};\r\n\r\nU.removeClass = (elem, classname) => {\r\n  if (classname) {\r\n    if (elem.classList) { elem.classList.remove(classname); } else { elem.className = elem.className.replace(new RegExp(`(^|\\\\b)${classname.split(' ').join('|')}(\\\\b|$)`, 'gi'), ' '); }\r\n  }\r\n};\r\n\r\n// if options is string -> returns css value\r\n// if options is array -> returns object with css value pairs\r\n// if options is object -> set new css values\r\nU.css = (elem, options) => {\r\n  if (_type.String(options)) {\r\n    return _getComputedStyle(elem)[_camelCase(options)];\r\n  } else if (_type.Array(options)) {\r\n    const obj = {};\r\n    const style = _getComputedStyle(elem);\r\n    options.forEach((option, key) => {\r\n      obj[option] = style[_camelCase(option)];\r\n    });\r\n    return obj;\r\n  }\r\n  for (const option in options) {\r\n    let val = options[option];\r\n    if (val === parseFloat(val)) { // assume pixel for seemingly numerical values\r\n      val += 'px';\r\n    }\r\n    elem.style[_camelCase(option)] = val;\r\n  }\r\n};\r\n\r\nexport default U;\r\n","class Event {\n  constructor(type, namespace, target, vars) {\n    vars = vars || {};\n    for (const key in vars) {\n      this[key] = vars[key];\n    }\n    this.type = type;\n    this.target = target;\n    this.currentTarget = target;\n    this.namespace = namespace || '';\n    this.timeStamp = Date.now();\n    this.timestamp = this.timeStamp;\n    return this;\n  }\n}\n\nexport default Event;\n","/* eslint-env browser */\n\nimport _util from './_util';\n\nconst FONT_SIZE = '0.85em';\nconst ZINDEX = '9999';\n\nconst TPL = {\n  start(color) {\n    // inner element (for bottom offset -1, while keeping top position 0)\n    const inner = document.createElement('div');\n    inner.textContent = 'start';\n    _util.css(inner, {\n      position: 'absolute',\n      overflow: 'visible',\n      'border-width': 0,\n      'border-style': 'solid',\n      color,\n      'border-color': color,\n    });\n    const element = document.createElement('div');\n    // wrapper\n    _util.css(element, {\n      position: 'absolute',\n      overflow: 'visible',\n      width: 0,\n      height: 0,\n    });\n    element.appendChild(inner);\n    return element;\n  },\n  end(color) {\n    const element = document.createElement('div');\n    element.textContent = 'end';\n    _util.css(element, {\n      position: 'absolute',\n      overflow: 'visible',\n      'border-width': 0,\n      'border-style': 'solid',\n      color,\n      'border-color': color,\n    });\n    return element;\n  },\n  bounds() {\n    const element = document.createElement('div');\n    _util.css(element, {\n      position: 'absolute',\n      overflow: 'visible',\n      'white-space': 'nowrap',\n      'pointer-events': 'none',\n      'font-size': FONT_SIZE,\n    });\n    element.style.zIndex = ZINDEX;\n    return element;\n  },\n  trigger(color) {\n    // inner to be above or below line but keep position\n    const inner = document.createElement('div');\n    inner.textContent = 'trigger';\n    _util.css(inner, {\n      position: 'relative',\n    });\n    // wrapper for right: 0 and main element has no size\n    const wrapper = document.createElement('div');\n    _util.css(wrapper, {\n      position: 'absolute',\n      overflow: 'visible',\n      'border-width': 0,\n      'border-style': 'solid',\n      color,\n      'border-color': color,\n    });\n    wrapper.appendChild(inner);\n    // element\n    const element = document.createElement('div');\n    _util.css(element, {\n      position: 'fixed',\n      overflow: 'visible',\n      'white-space': 'nowrap',\n      'pointer-events': 'none',\n      'font-size': FONT_SIZE,\n    });\n    element.style.zIndex = ZINDEX;\n    element.appendChild(wrapper);\n    return element;\n  },\n};\n\nlet _autoindex = 0;\n\nclass Indicator {\n  constructor(scene, options) {\n    options.name = options.name || _autoindex;\n\n    _autoindex++;\n\n    this._elemBounds = TPL.bounds();\n    this._elemStart = TPL.start(options.colorStart);\n    this._elemEnd = TPL.end(options.colorEnd);\n\n    this._boundsContainer = options.parent && _util.get.elements(options.parent)[0];\n\n    // prepare bounds elements\n    this._elemStart.firstChild.textContent += ` ${options.name}`;\n    this._elemEnd.textContent += ` ${options.name}`;\n    this._elemBounds.appendChild(this._elemStart);\n    this._elemBounds.appendChild(this._elemEnd);\n\n    this._vertical = null;\n    this._ctrl = null;\n\n    // set public variables\n    this.options = options;\n    this.bounds = this._elemBounds;\n    this.triggerGroup = null; // will be set later\n\n    this.scene = scene;\n  }\n\n  // add indicators to DOM\n  add() {\n    this._ctrl = this.scene.controller();\n    this._vertical = this._ctrl.info('vertical');\n\n    const isDocument = this._ctrl.info('isDocument');\n\n    if (!this._boundsContainer) {\n      // no parent supplied or doesnt exist\n      this._boundsContainer = isDocument ? document.body : this._ctrl.info('container'); // check if window/document (then use body)\n    }\n    if (!isDocument && _util.css(this._boundsContainer, 'position') === 'static') {\n      // position mode needed for correct positioning of indicators\n      _util.css(this._boundsContainer, { position: 'relative' });\n    }\n\n    // add listeners for updates\n    this.scene.on('change.plugin_addIndicators', this._handleTriggerParamsChange.bind(this));\n    this.scene.on('shift.plugin_addIndicators', this._handleBoundsParamsChange.bind(this));\n\n    // updates trigger & bounds (will add elements if needed)\n    this._updateTriggerGroup();\n    this._updateBounds();\n\n    setTimeout(() => { // do after all execution is finished otherwise sometimes size calculations are off\n      this._ctrl.updateBoundsPositions(this);\n    }, 0);\n\n    _util.log(3, 'added indicators');\n  }\n\n  // remove indicators from DOM\n  remove() {\n    if (this.triggerGroup) { // if not set there's nothing to remove\n      this.scene.off('change.plugin_addIndicators', this._handleTriggerParamsChange);\n      this.scene.off('shift.plugin_addIndicators', this._handleBoundsParamsChange);\n\n      if (this.triggerGroup.members.length > 1) {\n        // just remove from memberlist of old group\n        const group = this.triggerGroup;\n        group.members.splice(group.members.indexOf(this), 1);\n        this._ctrl.updateTriggerGroupLabel(group);\n        this._ctrl.updateTriggerGroupPositions(group);\n        this.triggerGroup = null;\n      } else {\n        // remove complete group\n        this._removeTriggerGroup();\n      }\n      this._removeBounds();\n\n      _util.log(3, 'removed indicators');\n    }\n  }\n\n  // event handler for when bounds params change\n  _handleBoundsParamsChange() {\n    this._updateBounds();\n  }\n\n  // event handler for when trigger params change\n  _handleTriggerParamsChange(event) {\n    if (event.what === 'triggerHook') {\n      this._updateTriggerGroup();\n    }\n  }\n\n  // adds an new bounds elements to the array and to the DOM\n  _addBounds() {\n    const v = this._ctrl.info('vertical');\n    // apply stuff we didn't know before...\n    _util.css(this._elemStart.firstChild, {\n      'border-bottom-width': v ? 1 : 0,\n      'border-right-width': v ? 0 : 1,\n      bottom: v ? -1 : this.options.indent,\n      right: v ? this.options.indent : -1,\n      padding: v ? '0 8px' : '2px 4px',\n    });\n    _util.css(this._elemEnd, {\n      'border-top-width': v ? 1 : 0,\n      'border-left-width': v ? 0 : 1,\n      top: v ? '100%' : '',\n      right: v ? this.options.indent : '',\n      bottom: v ? '' : this.options.indent,\n      left: v ? '' : '100%',\n      padding: v ? '0 8px' : '2px 4px',\n    });\n    // append\n    this._boundsContainer.appendChild(this._elemBounds);\n  }\n\n  // remove bounds from list and DOM\n  _removeBounds() {\n    this._elemBounds.parentNode.removeChild(this._elemBounds);\n  }\n\n  // update the start and end positions of the scene\n  _updateBounds() {\n    if (this._elemBounds.parentNode !== this._boundsContainer) {\n      this._addBounds(); // Add Bounds elements (start/end)\n    }\n    const css = {};\n    css[this._vertical ? 'top' : 'left'] = this.scene.triggerPosition();\n    css[this._vertical ? 'height' : 'width'] = this.scene.duration();\n    _util.css(this._elemBounds, css);\n    _util.css(this._elemEnd, {\n      display: this.scene.duration() > 0 ? '' : 'none',\n    });\n  }\n\n  // adds an new trigger group to the array and to the DOM\n  _addTriggerGroup() {\n    const triggerElem = TPL.trigger(this.options.colorTrigger); // new trigger element\n    const css = {};\n    css[this._vertical ? 'right' : 'bottom'] = 0;\n    css[this._vertical ? 'border-top-width' : 'border-left-width'] = 1;\n    _util.css(triggerElem.firstChild, css);\n    _util.css(triggerElem.firstChild.firstChild, {\n      padding: this._vertical ? '0 8px 3px 8px' : '3px 4px',\n    });\n    document.body.appendChild(triggerElem); // directly add to body\n    const newGroup = {\n      triggerHook: this.scene.triggerHook(),\n      element: triggerElem,\n      members: [this],\n    };\n    this._ctrl._indicators.groups.push(newGroup);\n    this.triggerGroup = newGroup;\n    // update right away\n    this._ctrl.updateTriggerGroupLabel(newGroup);\n    this._ctrl.updateTriggerGroupPositions(newGroup);\n  }\n\n  _removeTriggerGroup() {\n    this._ctrl._indicators.groups.splice(this._ctrl._indicators.groups.indexOf(this.triggerGroup), 1);\n    this.triggerGroup.element.parentNode.removeChild(this.triggerGroup.element);\n    this.triggerGroup = null;\n  }\n\n  // updates the trigger group -> either join existing or add new one\n  _updateTriggerGroup() {\n    const triggerHook = this.scene.triggerHook();\n    const closeEnough = 0.0001;\n\n    // Have a group, check if it still matches\n    if (this.triggerGroup) {\n      if (Math.abs(this.triggerGroup.triggerHook - triggerHook) < closeEnough) {\n        // _util.log(0, \"trigger\", options.name, \"->\", \"no need to change, still in sync\");\n        return; // all good\n      }\n    }\n\n    // Don't have a group, check if a matching one exists\n    // _util.log(0, \"trigger\", options.name, \"->\", \"out of sync!\");\n    const groups = this._ctrl._indicators.groups;\n    let group;\n    let i = groups.length;\n\n    while (i--) {\n      group = groups[i];\n      if (Math.abs(group.triggerHook - triggerHook) < closeEnough) {\n        // found a match!\n        // _util.log(0, \"trigger\", options.name, \"->\", \"found match\");\n        if (this.triggerGroup) { // do I have an old group that is out of sync?\n          if (this.triggerGroup.members.length === 1) { // is it the only remaining group?\n            // _util.log(0, \"trigger\", options.name, \"->\", \"kill\");\n            // was the last member, remove the whole group\n            this._removeTriggerGroup();\n          } else {\n            this.triggerGroup.members.splice(this.triggerGroup.members.indexOf(this), 1); // just remove from memberlist of old group\n            this._ctrl.updateTriggerGroupLabel(this.triggerGroup);\n            this._ctrl.updateTriggerGroupPositions(this.triggerGroup);\n            // _util.log(0, \"trigger\", options.name, \"->\", \"removing from previous member list\");\n          }\n        }\n        // join new group\n        group.members.push(this);\n        this.triggerGroup = group;\n        this._ctrl.updateTriggerGroupLabel(group);\n        return;\n      }\n    }\n\n    // at this point I am obviously out of sync and don't match any other group\n    if (this.triggerGroup) {\n      if (this.triggerGroup.members.length === 1) {\n        // _util.log(0, \"trigger\", options.name, \"->\", \"updating existing\");\n        // out of sync but i'm the only member => just change and update\n        this.triggerGroup.triggerHook = triggerHook;\n        this._ctrl.updateTriggerGroupPositions(this.triggerGroup);\n        return;\n      }\n      // _util.log(0, \"trigger\", options.name, \"->\", \"removing from previous member list\");\n      this.triggerGroup.members.splice(this.triggerGroup.members.indexOf(this), 1); // just remove from memberlist of old group\n      this._ctrl.updateTriggerGroupLabel(this.triggerGroup);\n      this._ctrl.updateTriggerGroupPositions(this.triggerGroup);\n      this.triggerGroup = null; // need a brand new group...\n    }\n    // _util.log(0, \"trigger\", options.name, \"->\", \"add a new one\");\n    // did not find any match, make new trigger group\n    this._addTriggerGroup();\n  }\n}\n\nexport default Indicator;\n","/* eslint-env browser */\r\n\r\nimport _util from './_util';\r\nimport Event from './Event';\r\nimport Indicator from './Indicator';\r\n\r\nconst PIN_SPACER_ATTRIBUTE = 'data-scrollmagic-pin-spacer';\r\n\r\nconst NAMESPACE = 'ScrollWizardry.Scene';\r\n\r\nconst SCENE_STATE_BEFORE = 'BEFORE';\r\nconst SCENE_STATE_DURING = 'DURING';\r\nconst SCENE_STATE_AFTER = 'AFTER';\r\n\r\nconst DEFAULT_INDICATOR_OPTIONS = {\r\n  name: '',\r\n  indent: 0,\r\n  parent: undefined,\r\n  colorStart: 'green',\r\n  colorEnd: 'red',\r\n  colorTrigger: 'blue',\r\n};\r\n\r\nconst DEFAULT_SCENE_OPTIONS = {\r\n  duration: 0,\r\n  offset: 0,\r\n  triggerElement: undefined,\r\n  triggerHook: 0.5,\r\n  reverse: true,\r\n  loglevel: 2,\r\n  tweenChanges: false,\r\n};\r\n\r\n// list of options that trigger a `shift` event\r\nconst SHIFTS = ['duration', 'offset', 'triggerHook'];\r\n\r\nclass Scene {\r\n  constructor(options) {\r\n    this.options = _util.extend({}, DEFAULT_SCENE_OPTIONS, options);\r\n\r\n    this._state = SCENE_STATE_BEFORE;\r\n    this._progress = 0;\r\n    this._scrollOffset = { start: 0, end: 0 };\r\n    this._triggerPos = 0;\r\n    this._durationUpdateMethod = null;\r\n    this._controller = null;\r\n    this._listeners = {};\r\n\r\n    this._pin = null;\r\n    this._pinOptions = null;\r\n\r\n    this._cssClasses = null;\r\n    this._cssClassElems = [];\r\n\r\n    this._tween = null;\r\n\r\n    this._indicator = null;\r\n\r\n    // add getters/setters for all possible options\r\n    for (const optionName in DEFAULT_SCENE_OPTIONS) {\r\n      this._addSceneOption(optionName);\r\n    }\r\n\r\n    this.validate = {\r\n      duration(val) {\r\n        if (_util.type.String(val) && val.match(/^(\\.|\\d)*\\d+%$/)) {\r\n        // percentage value\r\n          const perc = parseFloat(val) / 100;\r\n          val = () => {\r\n            return this._controller ? this._controller.info('size') * perc : 0;\r\n          };\r\n        }\r\n        if (_util.type.Function(val)) {\r\n        // function\r\n          this._durationUpdateMethod = val;\r\n          try {\r\n            val = parseFloat(this._durationUpdateMethod());\r\n          } catch (error) {\r\n            val = -1; // will cause error below\r\n          }\r\n        }\r\n        // val has to be float\r\n        val = parseFloat(val);\r\n        if (!_util.type.Number(val) || val < 0) {\r\n          if (this._durationUpdateMethod) {\r\n            this._durationUpdateMethod = null;\r\n            throw Error(`Invalid return value of supplied function for option \"duration\": ${val}`);\r\n          } else {\r\n            throw Error(`Invalid value for option \"duration\": ${val}`);\r\n          }\r\n        }\r\n        return val;\r\n      },\r\n      offset(val) {\r\n        if (_util.type.Function(val)) {\r\n          val = val();\r\n        }\r\n        val = parseFloat(val);\r\n        if (!_util.type.Number(val)) {\r\n          throw Error(`Invalid value for option \"offset\": ${val}`);\r\n        }\r\n        return val;\r\n      },\r\n      triggerElement(val) {\r\n        val = val || undefined;\r\n        if (val) {\r\n          const elem = _util.get.elements(val)[0];\r\n          if (elem && elem.parentNode) {\r\n            val = elem;\r\n          } else {\r\n            throw Error(`Element defined in option \"triggerElement\" was not found: ${val}`);\r\n          }\r\n        }\r\n        return val;\r\n      },\r\n      triggerHook(val) {\r\n        const translate = { onCenter: 0.5, onEnter: 1, onLeave: 0 };\r\n        if (_util.type.Number(val)) {\r\n          val = Math.max(0, Math.min(parseFloat(val), 1)); //  make sure its betweeen 0 and 1\r\n        } else if (val in translate) {\r\n          val = translate[val];\r\n        } else {\r\n          throw Error(`Invalid value for option \"triggerHook\": ${val}`);\r\n        }\r\n        return val;\r\n      },\r\n      reverse(val) {\r\n        return !!val; // force boolean\r\n      },\r\n      loglevel(val) {\r\n        val = parseInt(val, 10);\r\n        if (!_util.type.Number(val) || val < 0 || val > 3) {\r\n          throw Error(`Invalid value for option \"loglevel\": ${val}`);\r\n        }\r\n        return val;\r\n      },\r\n      tweenChanges(val) {\r\n        return !!val;\r\n      },\r\n    };\r\n\r\n    // validate all options\r\n    this._validateOption();\r\n\r\n    this.on('change.internal', (event) => {\r\n      if (event.what !== 'loglevel' && event.what !== 'tweenChanges') { // no need for a scene update scene with these options...\r\n        if (event.what === 'triggerElement') {\r\n          this._updateTriggerElementPosition();\r\n        } else if (event.what === 'reverse') { // the only property left that may have an impact on the current scene state. Everything else is handled by the shift event.\r\n          this.update();\r\n        }\r\n      }\r\n    });\r\n\r\n    this.on('shift.internal', (event) => {\r\n      this._updateScrollOffset();\r\n      this.update(); // update scene to reflect new position\r\n    });\r\n\r\n    // pinning\r\n\r\n    this.on('shift.internal', (event) => {\r\n      const durationChanged = event.reason === 'duration';\r\n      if ((this._state === SCENE_STATE_AFTER && durationChanged) || (this._state === SCENE_STATE_DURING && this.options.duration === 0)) {\r\n        // if [duration changed after a scene (inside scene progress updates pin position)] or [duration is 0, we are in pin phase and some other value changed].\r\n        this._updatePinState();\r\n      }\r\n      if (durationChanged) {\r\n        this._updatePinDimensions();\r\n      }\r\n    });\r\n\r\n    this.on('progress.internal', (event) => {\r\n      this._updatePinState();\r\n    });\r\n\r\n    this.on('add.internal', (event) => {\r\n      this._updatePinDimensions();\r\n    });\r\n\r\n    this.on('destroy.internal', (event) => {\r\n      this.removePin(event.reset);\r\n    });\r\n\r\n    // class toggle\r\n\r\n    this.on('destroy.internal', (event) => {\r\n      this.removeClassToggle(event.reset);\r\n    });\r\n\r\n    // gsap\r\n\r\n    this.on('progress.plugin_gsap', () => {\r\n      this._updateTweenProgress();\r\n    });\r\n\r\n    this.on('destroy.plugin_gsap', (event) => {\r\n      this.removeTween(event.reset);\r\n    });\r\n  }\r\n\r\n  on(names, callback) {\r\n    if (_util.type.Function(callback)) {\r\n      names = names.trim().split(' ');\r\n      names.forEach((fullname) => {\r\n        const nameparts = fullname.split('.');\r\n        const eventname = nameparts[0];\r\n        const namespace = nameparts[1];\r\n        if (eventname !== '*') { // disallow wildcards\r\n          if (!this._listeners[eventname]) {\r\n            this._listeners[eventname] = [];\r\n          }\r\n          this._listeners[eventname].push({\r\n            namespace: namespace || '',\r\n            callback,\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      _util.log(1, `ERROR when calling '.on()': Supplied callback for '${names}' is not a valid function!`);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  off(names, callback) {\r\n    if (!names) {\r\n      _util.log(1, 'ERROR: Invalid event name supplied.');\r\n      return this;\r\n    }\r\n    names = names.trim().split(' ');\r\n    names.forEach((fullname, key) => {\r\n      const nameparts = fullname.split('.');\r\n      const eventname = nameparts[0];\r\n      const namespace = nameparts[1] || '';\r\n      const removeList = eventname === '*' ? Object.keys(this._listeners) : [eventname];\r\n      removeList.forEach((remove) => {\r\n        const list = this._listeners[remove] || [];\r\n        let i = list.length;\r\n        while (i--) {\r\n          const listener = list[i];\r\n          if (listener && (namespace === listener.namespace || namespace === '*') && (!callback || callback === listener.callback)) {\r\n            list.splice(i, 1);\r\n          }\r\n        }\r\n        if (!list.length) {\r\n          delete this._listeners[remove];\r\n        }\r\n      });\r\n    });\r\n    return this;\r\n  }\r\n\r\n  trigger(name, vars) {\r\n    if (name) {\r\n      const nameparts = name.trim().split('.');\r\n      const eventname = nameparts[0];\r\n      const namespace = nameparts[1];\r\n      const listeners = this._listeners[eventname];\r\n      _util.log(3, 'event fired:', eventname, vars ? '->' : '', vars || '');\r\n      if (listeners) {\r\n        listeners.forEach((listener, key) => {\r\n          if (!namespace || namespace === listener.namespace) {\r\n            listener.callback.call(this, new Event(eventname, listener.namespace, this, vars));\r\n          }\r\n        });\r\n      }\r\n    } else {\r\n      _util.log(1, 'ERROR: Invalid event name supplied.');\r\n    }\r\n    return this;\r\n  }\r\n\r\n  addTo(controller) {\r\n    if (this._controller !== controller) {\r\n      // new controller\r\n      if (this._controller) { // was associated to a different controller before, so remove it...\r\n        this._controller.removeScene(this);\r\n      }\r\n      this._controller = controller;\r\n      this._validateOption();\r\n      this._updateDuration(true);\r\n      this._updateTriggerElementPosition(true);\r\n      this._updateScrollOffset();\r\n      this._controller.info('container').addEventListener('resize', this._onContainerResize.bind(this), { passive: true });\r\n      controller.addScene(this);\r\n      this.trigger('add', { controller: this._controller });\r\n      _util.log(3, `added ${NAMESPACE} to controller`);\r\n      this.update();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  remove() {\r\n    if (this._controller) {\r\n      this._controller.info('container').removeEventListener('resize', this._onContainerResize.bind(this), { passive: true });\r\n      const tmpParent = this._controller;\r\n      this._controller = null;\r\n      tmpParent.removeScene(this);\r\n      this.trigger('remove');\r\n      _util.log(3, `removed ${NAMESPACE} from controller`);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  destroy(reset) {\r\n    this.trigger('destroy', { reset });\r\n    this.remove();\r\n    this.triggerElement(null);\r\n    this.off('*.*');\r\n    _util.log(3, `destroyed ${NAMESPACE} (reset: ${reset ? 'true' : 'false'})`);\r\n    return null;\r\n  }\r\n\r\n  update(immediately) {\r\n    if (this._controller) {\r\n      if (immediately) {\r\n        if (this._controller.enabled()) {\r\n          const scrollPos = this._controller.info('scrollPos');\r\n          let newProgress;\r\n\r\n          if (this.options.duration > 0) {\r\n            newProgress = (scrollPos - this._scrollOffset.start) / (this._scrollOffset.end - this._scrollOffset.start);\r\n          } else {\r\n            newProgress = scrollPos >= this._scrollOffset.start ? 1 : 0;\r\n          }\r\n\r\n          this.trigger('update', { startPos: this._scrollOffset.start, endPos: this._scrollOffset.end, scrollPos });\r\n\r\n          this.progress(newProgress);\r\n        } else if (this._pin && this._state === SCENE_STATE_DURING) {\r\n          this._updatePinState(true); // unpin in position\r\n        }\r\n      } else {\r\n        this._controller.updateScene(this, false);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  refresh() {\r\n    this._updateDuration();\r\n    this._updateTriggerElementPosition();\r\n    // update trigger element position\r\n    return this;\r\n  }\r\n\r\n  progress(progress) {\r\n    if (!arguments.length) { // get\r\n      return this._progress;\r\n    } // set\r\n\r\n    let doUpdate = false;\r\n    const oldState = this._state;\r\n    const scrollDirection = this._controller ? this._controller.info('scrollDirection') : 'PAUSED';\r\n    const reverseOrForward = this.options.reverse || progress >= this._progress;\r\n    if (this.options.duration === 0) {\r\n      // zero duration scenes\r\n      doUpdate = this._progress !== progress;\r\n      this._progress = progress < 1 && reverseOrForward ? 0 : 1;\r\n      this._state = this._progress === 0 ? SCENE_STATE_BEFORE : SCENE_STATE_DURING;\r\n    } else {\r\n      // scenes with start and end\r\n      if (progress < 0 && this._state !== SCENE_STATE_BEFORE && reverseOrForward) {\r\n        // go back to initial state\r\n        this._progress = 0;\r\n        this._state = SCENE_STATE_BEFORE;\r\n        doUpdate = true;\r\n      } else if (progress >= 0 && progress < 1 && reverseOrForward) {\r\n        this._progress = progress;\r\n        this._state = SCENE_STATE_DURING;\r\n        doUpdate = true;\r\n      } else if (progress >= 1 && this._state !== SCENE_STATE_AFTER) {\r\n        this._progress = 1;\r\n        this._state = SCENE_STATE_AFTER;\r\n        doUpdate = true;\r\n      } else if (this._state === SCENE_STATE_DURING && !reverseOrForward) {\r\n        this._updatePinState(); // in case we scrolled backwards mid-scene and reverse is disabled => update the pin position, so it doesn't move back as well.\r\n      }\r\n    }\r\n    if (doUpdate) {\r\n      // fire events\r\n      const eventVars = { progress: this._progress, state: this._state, scrollDirection };\r\n      const stateChanged = this._state !== oldState;\r\n\r\n      const trigger = (eventName) => { // tmp helper to simplify code\r\n        this.trigger(eventName, eventVars);\r\n      };\r\n\r\n      if (stateChanged) { // enter events\r\n        if (oldState !== SCENE_STATE_DURING) {\r\n          trigger('enter');\r\n          trigger(oldState === SCENE_STATE_BEFORE ? 'start' : 'end');\r\n        }\r\n      }\r\n      trigger('progress');\r\n      if (stateChanged) { // leave events\r\n        if (this._state !== SCENE_STATE_DURING) {\r\n          trigger(this._state === SCENE_STATE_BEFORE ? 'start' : 'end');\r\n          trigger('leave');\r\n        }\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  _updateScrollOffset() {\r\n    const offset = _util.type.Function(this.options.offset) ? this.options.offset() : this.options.offset;\r\n    this._scrollOffset = { start: this._triggerPos + offset };\r\n    if (this._controller && this.options.triggerElement) {\r\n      // take away triggerHook portion to get relative to top\r\n      this._scrollOffset.start -= this._controller.info('size') * this.options.triggerHook;\r\n    }\r\n    this._scrollOffset.end = this._scrollOffset.start + this.options.duration;\r\n  }\r\n\r\n  _updateDuration(suppressEvents) {\r\n    // update duration\r\n    if (this._durationUpdateMethod) {\r\n      const varname = 'duration';\r\n      if (this._changeOption(varname, this._durationUpdateMethod.call(this)) && !suppressEvents) { // set\r\n        this.trigger('change', { what: varname, newVal: this.options[varname] });\r\n        this.trigger('shift', { reason: varname });\r\n      }\r\n    }\r\n  }\r\n\r\n  _updateTriggerElementPosition(suppressEvents) {\r\n    let elementPos = 0;\r\n    let telem = this.options.triggerElement;\r\n    if (this._controller && (telem || this._triggerPos > 0)) { // either an element exists or was removed and the triggerPos is still > 0\r\n      if (telem) { // there currently a triggerElement set\r\n        if (telem.parentNode) { // check if element is still attached to DOM\r\n          const controllerInfo = this._controller.info();\r\n          const containerOffset = _util.get.offset(controllerInfo.container); // container position is needed because element offset is returned in relation to document, not in relation to container.\r\n          const param = controllerInfo.vertical ? 'top' : 'left'; // which param is of interest ?\r\n\r\n          // if parent is spacer, use spacer position instead so correct start position is returned for pinned elements.\r\n          while (telem.parentNode.hasAttribute(PIN_SPACER_ATTRIBUTE)) {\r\n            telem = telem.parentNode;\r\n          }\r\n\r\n          const elementOffset = _util.get.offset(telem);\r\n\r\n          if (!controllerInfo.isDocument) { // container is not the document root, so substract scroll Position to get correct trigger element position relative to scrollcontent\r\n            containerOffset[param] -= this._controller.scrollPos();\r\n          }\r\n\r\n          elementPos = elementOffset[param] - containerOffset[param];\r\n        } else { // there was an element, but it was removed from DOM\r\n          _util.log(2, 'WARNING: triggerElement was removed from DOM and will be reset to', undefined);\r\n          this.triggerElement(undefined); // unset, so a change event is triggered\r\n        }\r\n      }\r\n\r\n      const changed = elementPos !== this._triggerPos;\r\n      this._triggerPos = elementPos;\r\n      if (changed && !suppressEvents) {\r\n        this.trigger('shift', { reason: 'triggerElementPosition' });\r\n      }\r\n    }\r\n  }\r\n\r\n  _onContainerResize(event) {\r\n    if (this.options.triggerHook > 0) {\r\n      this.trigger('shift', { reason: 'containerResize' });\r\n    }\r\n  }\r\n\r\n  _validateOption(...check) {\r\n    check = check.length ? check : Object.keys(this.validate);\r\n    check.forEach((optionName, key) => {\r\n      let value;\r\n      if (this.validate[optionName]) { // there is a validation method for this option\r\n        try { // validate value\r\n          value = this.validate[optionName].call(this, this.options[optionName]);\r\n        } catch (event) { // validation failed -> reset to default\r\n          value = DEFAULT_SCENE_OPTIONS[optionName];\r\n          const logMSG = _util.type.String(event) ? [event] : event;\r\n          if (_util.type.Array(logMSG)) {\r\n            logMSG[0] = `ERROR: ${logMSG[0]}`;\r\n            logMSG.unshift(1); // loglevel 1 for error msg\r\n            _util.log.apply(this, logMSG);\r\n          } else {\r\n            _util.log(1, `ERROR: Problem executing validation callback for option '${optionName}':`, event.message);\r\n          }\r\n        } finally {\r\n          // this.options[optionName] = value;\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  _changeOption(optionName, newVal) {\r\n    let changed = false;\r\n    const oldval = this.options[optionName];\r\n    if (this.options[optionName] !== newVal) {\r\n      this.options[optionName] = newVal;\r\n      this._validateOption(optionName); // resets to default if necessary\r\n      changed = oldval !== this.options[optionName];\r\n    }\r\n    return changed;\r\n  }\r\n\r\n  _addSceneOption(optionName) {\r\n    if (!this[optionName]) {\r\n      this[optionName] = (...args) => {\r\n        if (args.length === 0) { // get\r\n          return this.options[optionName];\r\n        }\r\n        if (optionName === 'duration') { // new duration is set, so any previously set function must be unset\r\n          this._durationUpdateMethod = null;\r\n        }\r\n        if (this._changeOption(optionName, args[0])) { // set\r\n          this.trigger('change', { what: optionName, newVal: this.options[optionName] });\r\n          if (SHIFTS.indexOf(optionName) > -1) {\r\n            this.trigger('shift', { reason: optionName });\r\n          }\r\n        }\r\n\r\n        return this;\r\n      };\r\n    }\r\n  }\r\n\r\n  controller() {\r\n    return this._controller;\r\n  }\r\n\r\n  state() {\r\n    return this._state;\r\n  }\r\n\r\n  scrollOffset() {\r\n    return this._scrollOffset.start;\r\n  }\r\n\r\n  triggerPosition() {\r\n    // the offset is the basis\r\n    let offset = _util.type.Function(this.options.offset) ? this.options.offset() : this.options.offset;\r\n    if (this._controller) {\r\n      // get the trigger position\r\n      if (this.options.triggerElement) {\r\n        // Element as trigger\r\n        offset += this._triggerPos;\r\n      } else {\r\n        // return the height of the triggerHook to start at the beginning\r\n        offset += this._controller.info('size') * this.triggerHook();\r\n      }\r\n    }\r\n    return offset;\r\n  }\r\n\r\n  // pinning\r\n\r\n  _updatePinState(forceUnpin) {\r\n    if (this._pin && this._controller) {\r\n      const containerInfo = this._controller.info();\r\n      const pinTarget = this._pinOptions.spacer.firstChild; // may be pin element or another spacer, if cascading pins\r\n\r\n      if (!forceUnpin && this._state === SCENE_STATE_DURING) { // during scene or if duration is 0 and we are past the trigger\r\n        // pinned state\r\n        if (_util.css(pinTarget, 'position') !== 'fixed') {\r\n          // change state before updating pin spacer (position changes due to fixed collapsing might occur.)\r\n          _util.css(pinTarget, { position: 'fixed' });\r\n          // update pin spacer\r\n          this._updatePinDimensions();\r\n        }\r\n\r\n        const fixedPos = _util.get.offset(this._pinOptions.spacer, true); // get viewport position of spacer\r\n        const scrollDistance = this.options.reverse || this.options.duration === 0 ?\r\n          containerInfo.scrollPos - this._scrollOffset.start // quicker\r\n          : Math.round(this._progress * this.options.duration * 10) / 10; // if no reverse and during pin the position needs to be recalculated using the progress\r\n\r\n        // add scrollDistance\r\n        fixedPos[containerInfo.vertical ? 'top' : 'left'] += scrollDistance;\r\n\r\n        // set new values\r\n        _util.css(this._pinOptions.spacer.firstChild, {\r\n          top: fixedPos.top,\r\n          left: fixedPos.left,\r\n        });\r\n      } else {\r\n        // unpinned state\r\n        const newCSS = {\r\n          position: this._pinOptions.inFlow ? 'relative' : 'absolute',\r\n          top: 0,\r\n          left: 0,\r\n        };\r\n        let change = _util.css(pinTarget, 'position') !== newCSS.position;\r\n\r\n        if (!this._pinOptions.pushFollowers) {\r\n          newCSS[containerInfo.vertical ? 'top' : 'left'] = this.options.duration * this._progress;\r\n        } else if (this.options.duration > 0) { // only concerns scenes with duration\r\n          if (this._state === SCENE_STATE_AFTER && parseFloat(_util.css(this._pinOptions.spacer, 'padding-top')) === 0) {\r\n            change = true; // if in after state but havent updated spacer yet (jumped past pin)\r\n          } else if (this._state === SCENE_STATE_BEFORE && parseFloat(_util.css(this._pinOptions.spacer, 'padding-bottom')) === 0) { // before\r\n            change = true; // jumped past fixed state upward direction\r\n          }\r\n        }\r\n        // set new values\r\n        _util.css(pinTarget, newCSS);\r\n        if (change) {\r\n          // update pin spacer if state changed\r\n          this._updatePinDimensions();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  _updatePinDimensions() {\r\n    if (this._pin && this._controller && this._pinOptions.inFlow) {\r\n      // no spacer resize, if original position is absolute\r\n\r\n      const after = (this._state === SCENE_STATE_AFTER);\r\n      const before = (this._state === SCENE_STATE_BEFORE);\r\n      const during = (this._state === SCENE_STATE_DURING);\r\n      const vertical = this._controller.info('vertical');\r\n      const pinTarget = this._pinOptions.spacer.firstChild; // usually the pined element but can also be another spacer (cascaded pins)\r\n      const marginCollapse = _util.isMarginCollapseType(_util.css(this._pinOptions.spacer, 'display'));\r\n      const css = {};\r\n\r\n      // set new size\r\n      // if relsize: spacer -> pin | else: pin -> spacer\r\n      if (this._pinOptions.relSize.width || this._pinOptions.relSize.autoFullWidth) {\r\n        if (during) {\r\n          _util.css(this._pin, { width: _util.get.width(this._pinOptions.spacer) });\r\n        } else {\r\n          _util.css(this._pin, { width: '100%' });\r\n        }\r\n      } else {\r\n        // minwidth is needed for cascaded pins.\r\n        css['min-width'] = _util.get.width(vertical ? this._pin : pinTarget, true, true);\r\n        css.width = during ? css['min-width'] : 'auto';\r\n      }\r\n      if (this._pinOptions.relSize.height) {\r\n        if (during) {\r\n          // the only padding the spacer should ever include is the duration (if pushFollowers = true), so we need to substract that.\r\n          _util.css(this._pin, { height: _util.get.height(this._pinOptions.spacer) - (this._pinOptions.pushFollowers ? this.options.duration : 0) });\r\n        } else {\r\n          _util.css(this._pin, { height: '100%' });\r\n        }\r\n      } else {\r\n        // margin is only included if it's a cascaded pin to resolve an IE9 bug\r\n        css['min-height'] = _util.get.height(vertical ? pinTarget : this._pin, true, !marginCollapse); // needed for cascading pins\r\n        css.height = during ? css['min-height'] : 'auto';\r\n      }\r\n\r\n      // add space for duration if pushFollowers is true\r\n      if (this._pinOptions.pushFollowers) {\r\n        css[`padding${vertical ? 'Top' : 'Left'}`] = this.options.duration * this._progress;\r\n        css[`padding${vertical ? 'Bottom' : 'Right'}`] = this.options.duration * (1 - this._progress);\r\n      }\r\n      _util.css(this._pinOptions.spacer, css);\r\n    }\r\n  }\r\n\r\n  _updatePinInContainer() {\r\n    if (this._controller && this._pin && this._state === SCENE_STATE_DURING && !this._controller.info('isDocument')) {\r\n      this._updatePinState();\r\n    }\r\n  }\r\n\r\n  _updateRelativePinSpacer() {\r\n    if (this._controller && this._pin &&\r\n      this._state === SCENE_STATE_DURING && // element in pinned state?\r\n      ( // is width or height relatively sized, but not in relation to body? then we need to recalc.\r\n        ((this._pinOptions.relSize.width || this._pinOptions.relSize.autoFullWidth) && _util.get.width(window) !== _util.get.width(this._pinOptions.spacer.parentNode)) ||\r\n        (this._pinOptions.relSize.height && _util.get.height(window) !== _util.get.height(this._pinOptions.spacer.parentNode))\r\n      )\r\n    ) {\r\n      this._updatePinDimensions();\r\n    }\r\n  }\r\n\r\n  _onMousewheelOverPin(event) {\r\n    if (this._controller && this._pin && this._state === SCENE_STATE_DURING && !this._controller.info('isDocument')) { // in pin state\r\n      event.preventDefault();\r\n      this._controller._setScrollPos(this._controller.info('scrollPos') - ((event.wheelDelta || event[this._controller.info('vertical') ? 'wheelDeltaY' : 'wheelDeltaX']) / 3 || -event.detail * 30));\r\n    }\r\n  }\r\n\r\n  setPin(element, settings) {\r\n    const defaultSettings = {\r\n      pushFollowers: true,\r\n      spacerClass: 'scrollmagic-pin-spacer',\r\n    };\r\n    settings = _util.extend({}, defaultSettings, settings);\r\n\r\n    // validate Element\r\n    element = _util.get.elements(element)[0];\r\n    if (!element) {\r\n      _util.log(1, \"ERROR calling method 'setPin()': Invalid pin element supplied.\");\r\n      return this; // cancel\r\n    } else if (_util.css(element, 'position') === 'fixed') {\r\n      _util.log(1, \"ERROR calling method 'setPin()': Pin does not work with elements that are positioned 'fixed'.\");\r\n      return this; // cancel\r\n    }\r\n\r\n    if (this._pin) { // preexisting pin?\r\n      if (this._pin === element) {\r\n        // same pin we already have -> do nothing\r\n        return this; // cancel\r\n      }\r\n      // kill old pin\r\n      this.removePin();\r\n    }\r\n    this._pin = element;\r\n\r\n    const parentDisplay = this._pin.parentNode.style.display;\r\n    const boundsParams = ['top', 'left', 'bottom', 'right', 'margin', 'marginLeft', 'marginRight', 'marginTop', 'marginBottom'];\r\n\r\n    this._pin.parentNode.style.display = 'none'; // hack start to force css to return stylesheet values instead of calculated px values.\r\n\r\n    const inFlow = _util.css(this._pin, 'position') !== 'absolute';\r\n    const pinCSS = _util.css(this._pin, boundsParams.concat(['display']));\r\n    const sizeCSS = _util.css(this._pin, ['width', 'height']);\r\n    this._pin.parentNode.style.display = parentDisplay; // hack end.\r\n\r\n    if (!inFlow && settings.pushFollowers) {\r\n      _util.log(2, 'WARNING: If the pinned element is positioned absolutely pushFollowers will be disabled.');\r\n      settings.pushFollowers = false;\r\n    }\r\n\r\n    // wait until all finished, because with responsive duration it will only be set after scene is added to controller\r\n    window.setTimeout(() => {\r\n      if (this._pin && this.options.duration === 0 && settings.pushFollowers) {\r\n        _util.log(2, 'WARNING: pushFollowers =', true, 'has no effect, when scene duration is 0.');\r\n      }\r\n    }, 0);\r\n\r\n    // create spacer and insert\r\n    const spacer = this._pin.parentNode.insertBefore(document.createElement('div'), this._pin);\r\n    const spacerCSS = _util.extend(pinCSS, {\r\n      position: inFlow ? 'relative' : 'absolute',\r\n      boxSizing: 'content-box',\r\n      mozBoxSizing: 'content-box',\r\n      webkitBoxSizing: 'content-box',\r\n    });\r\n\r\n    if (!inFlow) { // copy size if positioned absolutely, to work for bottom/right positioned elements.\r\n      _util.extend(spacerCSS, _util.css(this._pin, ['width', 'height']));\r\n    }\r\n\r\n    _util.css(spacer, spacerCSS);\r\n    spacer.setAttribute(PIN_SPACER_ATTRIBUTE, '');\r\n    _util.addClass(spacer, settings.spacerClass);\r\n\r\n    // set the pin Options\r\n    this._pinOptions = {\r\n      spacer,\r\n      relSize: { // save if size is defined using % values. if so, handle spacer resize differently...\r\n        width: sizeCSS.width.slice(-1) === '%',\r\n        height: sizeCSS.height.slice(-1) === '%',\r\n        autoFullWidth: sizeCSS.width === 'auto' && inFlow && _util.isMarginCollapseType(pinCSS.display),\r\n      },\r\n      pushFollowers: settings.pushFollowers,\r\n      inFlow, // stores if the element takes up space in the document flow\r\n    };\r\n\r\n    if (!this._pin.___origStyle) {\r\n      this._pin.___origStyle = {};\r\n      const pinInlineCSS = this._pin.style;\r\n      const copyStyles = boundsParams.concat(['width', 'height', 'position', 'boxSizing', 'mozBoxSizing', 'webkitBoxSizing']);\r\n      copyStyles.forEach((val) => {\r\n        this._pin.___origStyle[val] = pinInlineCSS[val] || '';\r\n      });\r\n    }\r\n\r\n    // if relative size, transfer it to spacer and make pin calculate it...\r\n    if (this._pinOptions.relSize.width) {\r\n      _util.css(spacer, { width: sizeCSS.width });\r\n    }\r\n    if (this._pinOptions.relSize.height) {\r\n      _util.css(spacer, { height: sizeCSS.height });\r\n    }\r\n\r\n    // now place the pin element inside the spacer\r\n    spacer.appendChild(this._pin);\r\n    // and set new css\r\n    _util.css(this._pin, {\r\n      position: inFlow ? 'relative' : 'absolute',\r\n      margin: 'auto',\r\n      top: 'auto',\r\n      left: 'auto',\r\n      bottom: 'auto',\r\n      right: 'auto',\r\n    });\r\n\r\n    if (this._pinOptions.relSize.width || this._pinOptions.relSize.autoFullWidth) {\r\n      _util.css(this._pin, {\r\n        boxSizing: 'border-box',\r\n        mozBoxSizing: 'border-box',\r\n        webkitBoxSizing: 'border-box',\r\n      });\r\n    }\r\n\r\n    // add listener to document to update pin position in case controller is not the document.\r\n    window.addEventListener('scroll', this._updatePinInContainer.bind(this), { passive: true });\r\n    window.addEventListener('resize', this._updatePinInContainer.bind(this), { passive: true });\r\n    window.addEventListener('resize', this._updateRelativePinSpacer.bind(this), { passive: true });\r\n    // add mousewheel listener to catch scrolls over fixed elements\r\n    this._pin.addEventListener('mousewheel', this._onMousewheelOverPin.bind(this));\r\n    this._pin.addEventListener('DOMMouseScroll', this._onMousewheelOverPin.bind(this));\r\n\r\n    _util.log(3, 'added pin');\r\n\r\n    // finally update the pin to init\r\n    this._updatePinState();\r\n\r\n    return this;\r\n  }\r\n\r\n  removePin(reset) {\r\n    if (this._pin) {\r\n      if (this._state === SCENE_STATE_DURING) {\r\n        this._updatePinState(true); // force unpin at position\r\n      }\r\n      if (reset || !this._controller) { // if there's no controller no progress was made anyway...\r\n        const pinTarget = this._pinOptions.spacer.firstChild; // usually the pin element, but may be another spacer (cascaded pins)...\r\n        if (pinTarget.hasAttribute(PIN_SPACER_ATTRIBUTE)) { // copy margins to child spacer\r\n          const style = this._pinOptions.spacer.style;\r\n          const values = ['margin', 'marginLeft', 'marginRight', 'marginTop', 'marginBottom'];\r\n          const margins = {};\r\n          values.forEach((val) => {\r\n            margins[val] = style[val] || '';\r\n          });\r\n          _util.css(pinTarget, margins);\r\n        }\r\n        this._pinOptions.spacer.parentNode.insertBefore(pinTarget, this._pinOptions.spacer);\r\n        this._pinOptions.spacer.parentNode.removeChild(this._pinOptions.spacer);\r\n        if (!this._pin.parentNode.hasAttribute(PIN_SPACER_ATTRIBUTE)) { // if it's the last pin for this element -> restore inline styles\r\n          // TODO: only correctly set for first pin (when cascading) - how to fix?\r\n          _util.css(this._pin, this._pin.___origStyle);\r\n          delete this._pin.___origStyle;\r\n        }\r\n      }\r\n      window.removeEventListener('scroll', this._updatePinInContainer.bind(this), { passive: true });\r\n      window.removeEventListener('resize', this._updatePinInContainer.bind(this), { passive: true });\r\n      window.removeEventListener('resize', this._updateRelativePinSpacer.bind(this), { passive: true });\r\n      this._pin.removeEventListener('mousewheel', this._onMousewheelOverPin.bind(this));\r\n      this._pin.removeEventListener('DOMMouseScroll', this._onMousewheelOverPin.bind(this));\r\n      this._pin = null;\r\n      this._pinOptions.spacer = null;\r\n      _util.log(3, `removed pin (reset: ${reset ? 'true' : 'false'})`);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  // class toggle\r\n\r\n  setClassToggle(element, classes) {\r\n    const elems = _util.get.elements(element);\r\n    if (elems.length === 0 || !_util.type.String(classes)) {\r\n      _util.log(1, `ERROR calling method 'setClassToggle()': Invalid ${elems.length === 0 ? 'element' : 'classes'} supplied.`);\r\n      return this;\r\n    }\r\n    if (this._cssClassElems.length > 0) {\r\n      // remove old ones\r\n      this.removeClassToggle();\r\n    }\r\n    this._cssClasses = classes;\r\n    this._cssClassElems = elems;\r\n    this.on('enter.internal_class leave.internal_class', (event) => {\r\n      const toggle = event.type === 'enter' ? _util.addClass : _util.removeClass;\r\n      this._cssClassElems.forEach((elem, key) => {\r\n        toggle(elem, this._cssClasses);\r\n      });\r\n    });\r\n    return this;\r\n  }\r\n\r\n  removeClassToggle(reset) {\r\n    if (reset) {\r\n      this._cssClassElems.forEach((elem, key) => {\r\n        _util.removeClass(elem, this._cssClasses);\r\n      });\r\n    }\r\n    this.off('start.internal_class end.internal_class');\r\n    this._cssClasses = null;\r\n    this._cssClassElems = [];\r\n    return this;\r\n  }\r\n\r\n  // gsap\r\n\r\n  _updateTweenProgress() {\r\n    if (this._tween) {\r\n      const progress = this.progress();\r\n      const state = this.state();\r\n      if (this._tween.repeat && this._tween.repeat() === -1) {\r\n        // infinite loop, so not in relation to progress\r\n        if (state === 'DURING' && this._tween.paused()) {\r\n          this._tween.play();\r\n        } else if (state !== 'DURING' && !this._tween.paused()) {\r\n          this._tween.pause();\r\n        }\r\n      } else if (progress !== this._tween.progress()) { // do we even need to update the progress?\r\n        // no infinite loop - so should we just play or go to a specific point in time?\r\n        if (this.duration() === 0) {\r\n          // play the animation\r\n          if (progress > 0) { // play from 0 to 1\r\n            this._tween.play();\r\n          } else { // play from 1 to 0\r\n            this._tween.reverse();\r\n          }\r\n        } else {\r\n          // go to a specific point in time\r\n          if (this.tweenChanges() && this._tween.tweenTo) {\r\n            // go smooth\r\n            this._tween.tweenTo(progress * this._tween.duration());\r\n          } else {\r\n            // just hard set it\r\n            this._tween.progress(progress).pause();\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  setTween(TweenObject, duration, params) {\r\n    let newTween;\r\n    if (arguments.length > 1) {\r\n      if (arguments.length < 3) {\r\n        params = duration;\r\n        duration = 1;\r\n      }\r\n      TweenObject = window.TweenMax.to(TweenObject, duration, params);\r\n    }\r\n    try {\r\n      // wrap Tween into a Timeline Object if available to include delay and repeats in the duration and standardize methods.\r\n      if (window.TimelineMax) {\r\n        newTween = new window.TimelineMax({ smoothChildTiming: true }).add(TweenObject);\r\n      } else {\r\n        newTween = TweenObject;\r\n      }\r\n      newTween.pause();\r\n    } catch (event) {\r\n      _util.log(1, \"ERROR calling method 'setTween()': Supplied argument is not a valid TweenObject\");\r\n      return this;\r\n    }\r\n\r\n    if (this._tween) {\r\n      // kill old tween\r\n      this.removeTween();\r\n    }\r\n\r\n    this._tween = newTween;\r\n\r\n    // some properties need to be transferred it to the wrapper, otherwise they would get lost.\r\n    if (TweenObject.repeat && TweenObject.repeat() === -1) {\r\n      this._tween.repeat(-1);\r\n      this._tween.yoyo(TweenObject.yoyo());\r\n    }\r\n\r\n    _util.log(3, 'added tween');\r\n\r\n    this._updateTweenProgress();\r\n\r\n    return this;\r\n  }\r\n\r\n  removeTween(reset) {\r\n    if (this._tween) {\r\n      if (reset) {\r\n        this._tween.progress(0).pause();\r\n      }\r\n      this._tween.kill();\r\n      this._tween = null;\r\n      _util.log(3, `removed tween (reset: ${reset ? 'true' : 'false'})`);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  // indicators\r\n\r\n  addIndicators(options) {\r\n    if (!this._indicator) {\r\n      options = _util.extend({}, DEFAULT_INDICATOR_OPTIONS, options);\r\n\r\n      this._indicator = new Indicator(this, options);\r\n\r\n      this.on('add.plugin_addIndicators', this._indicator.add.bind(this._indicator));\r\n      this.on('remove.plugin_addIndicators', this._indicator.remove.bind(this._indicator));\r\n      this.on('destroy.plugin_addIndicators', this.removeIndicators.bind(this));\r\n\r\n      // it the scene already has a controller we can start right away.\r\n      if (this.controller()) {\r\n        this._indicator.add();\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  removeIndicators() {\r\n    if (this._indicator) {\r\n      this._indicator.remove();\r\n      this.off('*.plugin_addIndicators');\r\n      this._indicator = null;\r\n    }\r\n    return this;\r\n  }\r\n}\r\n\r\nexport default Scene;\r\n","/* eslint-env browser */\r\n\r\nimport _util from './_util';\r\nimport Scene from './Scene';\r\n\r\nconst PIN_SPACER_ATTRIBUTE = 'data-scrollmagic-pin-spacer';\r\n\r\nconst NAMESPACE = 'ScrollWizardry.Controller';\r\n\r\nconst SCROLL_DIRECTION_FORWARD = 'FORWARD';\r\nconst SCROLL_DIRECTION_REVERSE = 'REVERSE';\r\nconst SCROLL_DIRECTION_PAUSED = 'PAUSED';\r\n\r\nconst EDGE_OFFSET = 15; // minimum edge distance, added to indentation\r\n\r\nconst DEFAULT_CONTROLLER_OPTIONS = {\r\n  container: window,\r\n  vertical: true,\r\n  globalSceneOptions: {},\r\n  loglevel: 2,\r\n  refreshInterval: 100,\r\n  addIndicators: false,\r\n};\r\n\r\nclass Controller {\r\n  constructor(options) {\r\n    this.options = _util.extend({}, DEFAULT_CONTROLLER_OPTIONS, options);\r\n\r\n    this.options.container = _util.get.elements(this.options.container)[0];\r\n\r\n    // check scroll container\r\n    if (!this.options.container) {\r\n      _util.log(1, `ERROR creating object ${NAMESPACE}: No valid scroll container supplied`);\r\n      throw Error(`${NAMESPACE} init failed.`); // cancel\r\n    }\r\n\r\n    this._isDocument = this.options.container === window || this.options.container === document.body || !document.body.contains(this.options.container);\r\n    this._sceneObjects = [];\r\n    this._updateScenesOnNextCycle = false;\r\n    this._scrollPos = 0;\r\n    this._scrollDirection = SCROLL_DIRECTION_PAUSED;\r\n    this._viewPortSize = 0;\r\n    this._enabled = true;\r\n    this._updateTimeout = null;\r\n    this._refreshTimeout = null;\r\n\r\n    // normalize to window\r\n    if (this._isDocument) {\r\n      this.options.container = window;\r\n    }\r\n\r\n    // update container size immediately\r\n    this._viewPortSize = this._getViewportSize();\r\n\r\n    // set event handlers\r\n    this.options.container.addEventListener('resize', this._onChange.bind(this), { passive: true });\r\n    this.options.container.addEventListener('scroll', this._onChange.bind(this), { passive: true });\r\n\r\n    const ri = parseInt(this.options.refreshInterval, 10);\r\n    this.options.refreshInterval = _util.type.Number(ri) ? ri : DEFAULT_CONTROLLER_OPTIONS.refreshInterval;\r\n    this._scheduleRefresh();\r\n\r\n    // indicators\r\n    this._info = this.info();\r\n    this._container = this._info.container;\r\n    this._isDocument = this._info.isDocument;\r\n    this._vertical = this._info.vertical;\r\n    this._indicators = { // container for all indicators and methods\r\n      groups: [],\r\n    };\r\n\r\n    if (this.options.addIndicators) {\r\n      this._container.addEventListener('resize', this._handleTriggerPositionChange.bind(this), { passive: true });\r\n      if (!this._isDocument) {\r\n        window.addEventListener('resize', this._handleTriggerPositionChange.bind(this), { passive: true });\r\n        window.addEventListener('scroll', this._handleTriggerPositionChange.bind(this), { passive: true });\r\n      }\r\n      // update all related bounds containers\r\n      this._container.addEventListener('resize', this._handleBoundsPositionChange.bind(this), { passive: true });\r\n      this._container.addEventListener('scroll', this._handleBoundsPositionChange.bind(this), { passive: true });\r\n    }\r\n\r\n    _util.log(3, `added new ${NAMESPACE}`);\r\n  }\r\n\r\n  _scheduleRefresh() {\r\n    if (this.options.refreshInterval > 0) {\r\n      this._refreshTimeout = window.setTimeout(this._refresh.bind(this), this.options.refreshInterval);\r\n    }\r\n  }\r\n\r\n  _getScrollPos() {\r\n    return this.options.vertical ? _util.get.scrollTop(this.options.container) : _util.get.scrollLeft(this.options.container);\r\n  }\r\n\r\n  _getViewportSize() {\r\n    return this.options.vertical ? _util.get.height(this.options.container) : _util.get.width(this.options.container);\r\n  }\r\n\r\n  _setScrollPos(pos) {\r\n    if (this.options.vertical) {\r\n      if (this._isDocument) {\r\n        window.scrollTo(_util.get.scrollLeft(), pos);\r\n      } else {\r\n        this.options.container.scrollTop = pos;\r\n      }\r\n    } else if (this._isDocument) {\r\n      window.scrollTo(pos, _util.get.scrollTop());\r\n    } else {\r\n      this.options.container.scrollLeft = pos;\r\n    }\r\n  }\r\n\r\n  _updateScenes() {\r\n    if (this._enabled && this._updateScenesOnNextCycle) {\r\n      // determine scenes to update\r\n      const scenesToUpdate = _util.type.Array(this._updateScenesOnNextCycle) ? this._updateScenesOnNextCycle : this._sceneObjects.slice(0);\r\n\r\n      // reset scenes\r\n      this._updateScenesOnNextCycle = false;\r\n\r\n      const oldScrollPos = this._scrollPos;\r\n\r\n      // update scroll pos now instead of on change, as it might have changed since scheduling (i.e. in-browser smooth scroll)\r\n      this._scrollPos = this.scrollPos();\r\n\r\n      const deltaScroll = this._scrollPos - oldScrollPos;\r\n\r\n      if (deltaScroll !== 0) { // scroll position changed?\r\n        this._scrollDirection = (deltaScroll > 0) ? SCROLL_DIRECTION_FORWARD : SCROLL_DIRECTION_REVERSE;\r\n      }\r\n\r\n      // reverse order of scenes if scrolling reverse\r\n      if (this._scrollDirection === SCROLL_DIRECTION_REVERSE) {\r\n        scenesToUpdate.reverse();\r\n      }\r\n\r\n      // update scenes\r\n      scenesToUpdate.forEach((scene, index) => {\r\n        _util.log(3, `updating scene ${index + 1}/${scenesToUpdate.length} (${this._sceneObjects.length} total)`);\r\n        scene.update(true);\r\n      });\r\n\r\n      if (scenesToUpdate.length === 0 && this.options.loglevel >= 3) {\r\n        _util.log(3, 'updating 0 scenes (nothing added to controller)');\r\n      }\r\n    }\r\n  }\r\n\r\n  _debounceUpdate() {\r\n    this._updateTimeout = _util.rAF(this._updateScenes.bind(this));\r\n  }\r\n\r\n  _onChange(event) {\r\n    _util.log(3, 'event fired causing an update:', event.type);\r\n    if (event.type === 'resize') {\r\n      // resize\r\n      this._viewPortSize = this._getViewportSize();\r\n      this._scrollDirection = SCROLL_DIRECTION_PAUSED;\r\n    }\r\n    // schedule update\r\n    if (this._updateScenesOnNextCycle !== true) {\r\n      this._updateScenesOnNextCycle = true;\r\n      this._debounceUpdate();\r\n    }\r\n  }\r\n\r\n  _refresh() {\r\n    if (!this._isDocument) {\r\n      // simulate resize event, only works for viewport relevant param (performance)\r\n      if (this._viewPortSize !== this._getViewportSize()) {\r\n        let resizeEvent;\r\n        try {\r\n          resizeEvent = new Event('resize', { bubbles: false, cancelable: false });\r\n        } catch (event) { // stupid IE\r\n          resizeEvent = document.createEvent('Event');\r\n          resizeEvent.initEvent('resize', false, false);\r\n        }\r\n        this.options.container.dispatchEvent(resizeEvent);\r\n      }\r\n    }\r\n\r\n    // refresh all scenes\r\n    this._sceneObjects.forEach((scene, index) => {\r\n      scene.refresh();\r\n    });\r\n\r\n    this._scheduleRefresh();\r\n  }\r\n\r\n  _sortScenes(scenesArray) {\r\n    if (scenesArray.length <= 1) {\r\n      return scenesArray;\r\n    }\r\n    const scenes = scenesArray.slice(0);\r\n    scenes.sort((a, b) => (a.scrollOffset() > b.scrollOffset() ? 1 : -1));\r\n    return scenes;\r\n  }\r\n\r\n  addScene(newScene) {\r\n    if (_util.type.Array(newScene)) {\r\n      newScene.forEach((scene, index) => {\r\n        this.addScene(scene);\r\n      });\r\n    } else if (newScene.controller() !== this) {\r\n      newScene.addTo(this);\r\n    } else if (this._sceneObjects.indexOf(newScene) < 0) {\r\n      // new scene\r\n      this._sceneObjects.push(newScene); // add to array\r\n      this._sceneObjects = this._sortScenes(this._sceneObjects); // sort\r\n      newScene.on('shift.controller_sort', () => { // resort whenever scene moves\r\n        this._sceneObjects = this._sortScenes(this._sceneObjects);\r\n      });\r\n      // insert global defaults.\r\n      for (const key in this.options.globalSceneOptions) {\r\n        if (newScene[key]) {\r\n          newScene[key].call(newScene, this.options.globalSceneOptions[key]);\r\n        }\r\n      }\r\n      _util.log(3, `adding Scene (now ${this._sceneObjects.length} total)`);\r\n    }\r\n\r\n    // indicators\r\n\r\n    if (this.options.addIndicators) {\r\n      if (newScene instanceof Scene && newScene.controller() === this) {\r\n        newScene.addIndicators();\r\n      }\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  removeScene(scene) {\r\n    if (_util.type.Array(scene)) {\r\n      scene.forEach((_scene, index) => {\r\n        this.removeScene(_scene);\r\n      });\r\n    } else {\r\n      const index = this._sceneObjects.indexOf(scene);\r\n      if (index > -1) {\r\n        scene.off('shift.controller_sort');\r\n        this._sceneObjects.splice(index, 1);\r\n        _util.log(3, `removing Scene (now ${this._sceneObjects.length} left)`);\r\n        scene.remove();\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  updateScene(scene, immediately) {\r\n    if (_util.type.Array(scene)) {\r\n      scene.forEach((_scene, index) => {\r\n        this.updateScene(_scene, immediately);\r\n      });\r\n    } else if (immediately) {\r\n      scene.update(true);\r\n\r\n    // if this._updateScenesOnNextCycle is true, all connected scenes are already scheduled for update\r\n    } else if (this._updateScenesOnNextCycle !== true) {\r\n      // prep array for next update cycle\r\n      this._updateScenesOnNextCycle = this._updateScenesOnNextCycle || [];\r\n      if (this._updateScenesOnNextCycle.indexOf(scene) === -1) {\r\n        this._updateScenesOnNextCycle.push(scene);\r\n      }\r\n      this._updateScenesOnNextCycle = this._sortScenes(this._updateScenesOnNextCycle); // sort\r\n      this._debounceUpdate();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  update(immediately) {\r\n    this._onChange({ type: 'resize' }); // will update size and set _updateScenesOnNextCycle to true\r\n    if (immediately) {\r\n      this._updateScenes();\r\n    }\r\n    return this;\r\n  }\r\n\r\n  scrollTo(scrollTarget, additionalParameter) {\r\n    if (_util.type.Number(scrollTarget)) { // excecute\r\n      this._setScrollPos.call(this.options.container, scrollTarget, additionalParameter);\r\n    } else if (_util.type.Function(scrollTarget)) { // assign new scroll function\r\n      this._setScrollPos = scrollTarget;\r\n    } else if (scrollTarget instanceof HTMLElement) { // scroll to element\r\n      let elem = _util.get.elements(scrollTarget)[0];\r\n      if (elem) {\r\n        // if parent is pin spacer, use spacer position instead so correct start position is returned for pinned elements.\r\n        while (elem.parentNode.hasAttribute(PIN_SPACER_ATTRIBUTE)) {\r\n          elem = elem.parentNode;\r\n        }\r\n\r\n        // which param is of interest ?\r\n        const param = this.options.vertical ? 'top' : 'left';\r\n\r\n        // container position is needed because element offset is returned in relation to document, not in relation to container.\r\n        const containerOffset = _util.get.offset(this.options.container);\r\n\r\n        const elementOffset = _util.get.offset(elem);\r\n\r\n        if (!this._isDocument) { // container is not the document root, so substract scroll Position to get correct trigger element position relative to scrollcontent\r\n          containerOffset[param] -= this.scrollPos();\r\n        }\r\n\r\n        this.scrollTo(elementOffset[param] - containerOffset[param], additionalParameter);\r\n      } else {\r\n        _util.log(2, 'scrollTo(): The supplied argument is invalid. Scroll cancelled.', scrollTarget);\r\n      }\r\n    } else if (scrollTarget instanceof Scene) { // scroll to scene\r\n      if (scrollTarget.controller() === this) { // check if the controller is associated with this scene\r\n        this.scrollTo(scrollTarget.scrollOffset(), additionalParameter);\r\n      } else {\r\n        _util.log(2, 'scrollTo(): The supplied scene does not belong to this controller. Scroll cancelled.', scrollTarget);\r\n      }\r\n    }\r\n    return this;\r\n  }\r\n\r\n  scrollPos(scrollPosMethod) {\r\n    if (!arguments.length) { // get\r\n      return this._getScrollPos.call(this);\r\n    } // set\r\n    if (_util.type.Function(scrollPosMethod)) {\r\n      this._getScrollPos = scrollPosMethod;\r\n    } else {\r\n      _util.log(2, \"Provided value for method 'scrollPos' is not a function. To change the current scroll position use 'scrollTo()'.\");\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  info(about) {\r\n    const values = {\r\n      size: this._viewPortSize, // contains height or width (in regard to orientation)\r\n      vertical: this.options.vertical,\r\n      scrollPos: this._scrollPos,\r\n      scrollDirection: this._scrollDirection,\r\n      container: this.options.container,\r\n      isDocument: this._isDocument,\r\n    };\r\n    if (values[about]) {\r\n      return values[about];\r\n    }\r\n    return values;\r\n  }\r\n\r\n  loglevel(newLoglevel) {\r\n    if (!arguments.length) { // get\r\n      return this.options.loglevel;\r\n    } else if (this.options.loglevel !== newLoglevel) { // set\r\n      this.options.loglevel = newLoglevel;\r\n    }\r\n    return this;\r\n  }\r\n\r\n  enabled(newState) {\r\n    if (!arguments.length) { // get\r\n      return this._enabled;\r\n    } else if (this._enabled !== newState) { // set\r\n      this._enabled = !!newState;\r\n      this.updateScene(this._sceneObjects, true);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  destroy(resetScenes) {\r\n    window.clearTimeout(this._refreshTimeout);\r\n\r\n    let i = this._sceneObjects.length;\r\n\r\n    while (i--) {\r\n      this._sceneObjects[i].destroy(resetScenes);\r\n    }\r\n\r\n    this.options.container.removeEventListener('resize', this._onChange.bind(this), { passive: true });\r\n    this.options.container.removeEventListener('scroll', this._onChange.bind(this), { passive: true });\r\n\r\n    _util.cAF(this._updateTimeout);\r\n\r\n    _util.log(3, `destroyed ${NAMESPACE} (reset: ${resetScenes ? 'true' : 'false'})`);\r\n\r\n    // indicators\r\n\r\n    if (this.options.addIndicators) {\r\n      this._container.removeEventListener('resize', this._handleTriggerPositionChange.bind(this), { passive: true });\r\n      if (!this._isDocument) {\r\n        window.removeEventListener('resize', this._handleTriggerPositionChange.bind(this), { passive: true });\r\n        window.removeEventListener('scroll', this._handleTriggerPositionChange.bind(this), { passive: true });\r\n      }\r\n      this._container.removeEventListener('resize', this._handleBoundsPositionChange.bind(this), { passive: true });\r\n      this._container.removeEventListener('scroll', this._handleBoundsPositionChange.bind(this), { passive: true });\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  // indicators\r\n\r\n  // event handler for when associated bounds markers need to be repositioned\r\n  _handleBoundsPositionChange() {\r\n    this.updateBoundsPositions();\r\n  }\r\n\r\n  // event handler for when associated trigger groups need to be repositioned\r\n  _handleTriggerPositionChange() {\r\n    this.updateTriggerGroupPositions();\r\n\r\n    this._sceneObjects.forEach((scene, index) => {\r\n      if (scene._indicator) {\r\n        scene._indicator._updateBounds();\r\n      }\r\n    });\r\n  }\r\n\r\n  // updates the position of the bounds container to aligned to the right for vertical containers and to the bottom for horizontal\r\n  updateBoundsPositions(specificIndicator) {\r\n    // constant for all bounds\r\n    const groups = specificIndicator ?\r\n      [_util.extend({}, specificIndicator.triggerGroup, { members: [specificIndicator] })] : // create a group with only one element\r\n      this._indicators.groups; // use all\r\n    let g = groups.length;\r\n    const css = {};\r\n    const paramPos = this._vertical ? 'left' : 'top';\r\n    const paramDimension = this._vertical ? 'width' : 'height';\r\n    const edge = this._vertical ?\r\n      _util.get.scrollLeft(this._container) + _util.get.width(this._container) - EDGE_OFFSET :\r\n      _util.get.scrollTop(this._container) + _util.get.height(this._container) - EDGE_OFFSET;\r\n    let b;\r\n    let triggerSize;\r\n    let group;\r\n    while (g--) { // group loop\r\n      group = groups[g];\r\n      b = group.members.length;\r\n      triggerSize = _util.get[paramDimension](group.element.firstChild);\r\n      while (b--) { // indicators loop\r\n        css[paramPos] = edge - triggerSize;\r\n        _util.css(group.members[b].bounds, css);\r\n      }\r\n    }\r\n  }\r\n\r\n  // updates the positions of all trigger groups attached to a controller or a specific one, if provided\r\n  updateTriggerGroupPositions(specificGroup) {\r\n    // constant vars\r\n    const groups = specificGroup ? [specificGroup] : this._indicators.groups;\r\n    let i = groups.length;\r\n    const container = this._isDocument ? document.body : this._container;\r\n    const containerOffset = this._isDocument ? { top: 0, left: 0 } : _util.get.offset(container, true);\r\n    const edge = this._vertical ?\r\n      _util.get.width(this._container) - EDGE_OFFSET :\r\n      _util.get.height(this._container) - EDGE_OFFSET;\r\n    const paramDimension = this._vertical ? 'width' : 'height';\r\n    const paramTransform = this._vertical ? 'Y' : 'X';\r\n    // changing vars\r\n    let group;\r\n    let elem;\r\n    let pos;\r\n    let elemSize;\r\n    let transform;\r\n    while (i--) {\r\n      group = groups[i];\r\n      elem = group.element;\r\n      pos = group.triggerHook * this.info('size');\r\n      elemSize = _util.get[paramDimension](elem.firstChild.firstChild);\r\n      transform = pos > elemSize ? `translate${paramTransform}(-100%)` : '';\r\n\r\n      _util.css(elem, {\r\n        top: containerOffset.top + (this._vertical ? pos : edge - group.members[0].options.indent),\r\n        left: containerOffset.left + (this._vertical ? edge - group.members[0].options.indent : pos),\r\n      });\r\n      _util.css(elem.firstChild.firstChild, {\r\n        '-ms-transform': transform,\r\n        '-webkit-transform': transform,\r\n        transform,\r\n      });\r\n    }\r\n  }\r\n\r\n  // updates the label for the group to contain the name, if it only has one member\r\n  updateTriggerGroupLabel(group) {\r\n    const text = `trigger${group.members.length > 1 ? '' : ` ${group.members[0].options.name}`}`;\r\n    const elem = group.element.firstChild.firstChild;\r\n    const doUpdate = elem.textContent !== text;\r\n    if (doUpdate) {\r\n      elem.textContent = text;\r\n      if (this._vertical) { // bounds position is dependent on text length, so update\r\n        this.updateBoundsPositions();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default Controller;\r\n","/* eslint-env browser */\n\nimport Controller from './Controller';\nimport Scene from './Scene';\n\n// TODO: temporary workaround for chrome's scroll jitter bug\n// window.addEventListener('mousewheel', () => {}, { passive: true });\n\nexport {\n  Controller,\n  Scene,\n};\n"],"names":["DEBUG","U","i","_type","Object","prototype","toString","call","v","replace","toLowerCase","String","Function","Array","isArray","Number","parseFloat","DomElement","HTMLElement","o","SVGElement","nodeType","nodeName","type","_getComputedStyle","elem","currentStyle","window","getComputedStyle","_dimension","which","outer","includeMargin","document","charAt","toUpperCase","substr","dimension","style","floatVal","marginTop","marginBottom","marginLeft","marginRight","_camelCase","str","g","number","extend","obj","arguments","length","key","hasOwnProperty","isMarginCollapseType","indexOf","lastTime","vendors","_requestAnimationFrame","requestAnimationFrame","_cancelAnimationFrame","cancelAnimationFrame","callback","currTime","Date","getTime","timeToCall","Math","max","id","setTimeout","clearTimeout","rAF","bind","cAF","loglevels","console","log","method","loglevel","now","time","getHours","slice","getMinutes","getSeconds","getMilliseconds","args","splice","func","unshift","apply","_get","elements","selector","arr","querySelectorAll","e","ref","scrollTop","pageYOffset","scrollLeft","pageXOffset","width","height","offset","relativeToViewport","top","left","getBoundingClientRect","rect","get","addClass","classname","classList","add","className","removeClass","remove","RegExp","split","join","css","options","forEach","option","val","Event","namespace","target","vars","currentTarget","timeStamp","timestamp","FONT_SIZE","ZINDEX","TPL","color","inner","createElement","textContent","element","appendChild","zIndex","wrapper","_autoindex","Indicator","scene","name","_elemBounds","bounds","_elemStart","start","colorStart","_elemEnd","end","colorEnd","_boundsContainer","parent","_util","firstChild","_vertical","_ctrl","triggerGroup","controller","info","isDocument","body","position","on","_handleTriggerParamsChange","_handleBoundsParamsChange","_updateTriggerGroup","_updateBounds","updateBoundsPositions","off","members","group","updateTriggerGroupLabel","updateTriggerGroupPositions","_removeTriggerGroup","_removeBounds","event","what","indent","parentNode","removeChild","_addBounds","triggerPosition","duration","triggerElem","trigger","colorTrigger","newGroup","triggerHook","_indicators","groups","push","closeEnough","abs","_addTriggerGroup","PIN_SPACER_ATTRIBUTE","NAMESPACE","SCENE_STATE_BEFORE","SCENE_STATE_DURING","SCENE_STATE_AFTER","DEFAULT_INDICATOR_OPTIONS","undefined","DEFAULT_SCENE_OPTIONS","SHIFTS","Scene","_state","_progress","_scrollOffset","_triggerPos","_durationUpdateMethod","_controller","_listeners","_pin","_pinOptions","_cssClasses","_cssClassElems","_tween","_indicator","optionName","_addSceneOption","validate","match","perc","error","Error","translate","onCenter","onEnter","onLeave","min","parseInt","_validateOption","_updateTriggerElementPosition","update","_updateScrollOffset","durationChanged","reason","_updatePinState","_updatePinDimensions","removePin","reset","removeClassToggle","_updateTweenProgress","removeTween","names","trim","fullname","nameparts","eventname","removeList","keys","list","listener","listeners","removeScene","_updateDuration","addEventListener","_onContainerResize","passive","addScene","removeEventListener","tmpParent","triggerElement","immediately","enabled","scrollPos","newProgress","startPos","endPos","progress","updateScene","doUpdate","oldState","scrollDirection","reverseOrForward","reverse","eventVars","state","stateChanged","eventName","suppressEvents","varname","_changeOption","newVal","elementPos","telem","controllerInfo","containerOffset","container","param","vertical","hasAttribute","elementOffset","changed","check","value","logMSG","message","oldval","forceUnpin","containerInfo","pinTarget","spacer","fixedPos","scrollDistance","round","newCSS","inFlow","change","pushFollowers","after","before","during","marginCollapse","relSize","autoFullWidth","preventDefault","_setScrollPos","wheelDelta","detail","settings","defaultSettings","parentDisplay","display","boundsParams","pinCSS","concat","sizeCSS","insertBefore","spacerCSS","setAttribute","spacerClass","___origStyle","pinInlineCSS","copyStyles","_updatePinInContainer","_updateRelativePinSpacer","_onMousewheelOverPin","values","margins","classes","elems","toggle","repeat","paused","play","pause","tweenChanges","tweenTo","TweenObject","params","newTween","TweenMax","to","TimelineMax","smoothChildTiming","yoyo","kill","removeIndicators","SCROLL_DIRECTION_FORWARD","SCROLL_DIRECTION_REVERSE","SCROLL_DIRECTION_PAUSED","EDGE_OFFSET","DEFAULT_CONTROLLER_OPTIONS","Controller","_isDocument","contains","_sceneObjects","_updateScenesOnNextCycle","_scrollPos","_scrollDirection","_viewPortSize","_enabled","_updateTimeout","_refreshTimeout","_getViewportSize","_onChange","ri","refreshInterval","_scheduleRefresh","_info","_container","addIndicators","_handleTriggerPositionChange","_handleBoundsPositionChange","_refresh","pos","scrollTo","scenesToUpdate","oldScrollPos","deltaScroll","index","_updateScenes","_debounceUpdate","resizeEvent","bubbles","cancelable","createEvent","initEvent","dispatchEvent","refresh","scenesArray","scenes","sort","a","b","scrollOffset","newScene","addTo","_sortScenes","globalSceneOptions","_scene","scrollTarget","additionalParameter","scrollPosMethod","_getScrollPos","about","newLoglevel","newState","resetScenes","destroy","specificIndicator","paramPos","paramDimension","edge","triggerSize","specificGroup","paramTransform","elemSize","transform","text"],"mappings":"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"}